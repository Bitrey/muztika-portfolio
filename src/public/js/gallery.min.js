var polaroidGallery=function(){var a={},d=0,s=null,r=60,t=null,n=new XMLHttpRequest;function o(e){var t=1.8,n=(window.innerWidth-e.item.offsetWidth)/2,i=(window.innerHeight-r-e.item.offsetHeight)/2;e.item.style.zIndex=999,e.item.style.WebkitTransform="translate("+n+"px,"+i+"px) scale("+t+","+t+")",e.item.style.mozTransform="translate("+n+"px,"+i+"px) scale("+t+","+t+")",e.item.style.msTransform="translate("+n+"px,"+i+"px) scale("+t+","+t+")",e.item.style.transform="translate("+n+"px,"+i+"px) scale("+t+","+t+")",s=e}function l(e){var t=Math.random(),n=Math.random(),i=90*Math.random()-45,a=Math.floor((window.innerWidth-e.item.offsetWidth)*t),d=Math.floor((window.innerHeight-e.item.offsetHeight-r)*n);e.item.style.zIndex=1,e.item.style.WebkitTransform="translate("+a+"px,"+d+"px) rotate("+i+"deg)",e.item.style.mozTransform="translate("+a+"px,"+d+"px) rotate("+i+"deg)",e.item.style.msTransform="translate("+a+"px,"+d+"px) rotate("+i+"deg)",e.item.style.transform="translate("+a+"px,"+d+"px) rotate("+i+"deg)"}function f(){for(var e in a)e!=s.item.id&&l(a[e])}return function(e){!function(){var t=window.MutationObserver||window.WebKitMutationObserver,i=window.addEventListener;return function(e,n){t?new t(function(e,t){(e[0].addedNodes.length||e[0].removedNodes.length)&&n(e)}).observe(e,{childList:!0,subtree:!1}):i&&e.addEventListener("DOMNodeInserted",n,!1)}}()(document.getElementById("gallery"),function(e){[].slice.call(e[0].addedNodes).forEach(function(e){var t=e.getElementsByTagName("img")[0],n=e.getElementsByTagName("figure")[0],i=!0;t.addEventListener("load",function(){e.style.height=n.offsetHeight.toString()+"px",e.style.width=n.offsetWidth.toString()+"px",a[e.id]={item:e,width:e.offsetWidth,height:t.offsetHeight},i&&(s=a[e.id],i=!1),d++,e.addEventListener("click",function(){s!=a[e.id]||null==s?(o(a[e.id]),f()):!0===e.classList.contains("flipped")?e.classList.remove("flipped"):e.classList.add("flipped")}),l(a[e.id])})})}),n.onreadystatechange=function(){4==n.readyState&&200==n.status&&(function(e){var t,n="";for(t=0;t<e.length;t++)n+='<div class="photo" id="'+t+'"><div class="side side-front"><figure><img src="'+e[t].name+'" alt="'+e[t].name+'"/><figcaption>'+e[t].caption+'</figcaption></figure></div><div class="side side-back"><div><p>'+e[t].description+"</p></div></div></div>";document.getElementById("gallery").innerHTML=n}(JSON.parse(n.responseText)),r=document.getElementById("nav").offsetHeight,function(){var e=document.getElementById("next"),t=document.getElementById("preview");e.addEventListener("click",function(){var e=Number(s.item.id)+1;d<=e&&(e=0),o(a[e]),f()}),t.addEventListener("click",function(){var e=Number(s.item.id)-1;e<0&&(e=d-1),o(a[e]),f()})}(),window.addEventListener("resize",function(){t&&clearTimeout(t),t=setTimeout(function(){f(),s&&o(s)},100)}))},n.open("GET",e,!0),n.send()}}();